{{- if .Values.backend.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "gordon.fullname" . }}-backend-secret
  labels:
    {{- include "gordon.labels" . | nindent 4 }}
    app.kubernetes.io/component: backend
type: Opaque
stringData:
  # OpenRouter API Configuration (primary)
  {{- if .Values.backend.secrets.openRouterApiKey }}
  OPEN_ROUTER_API_KEY: {{ .Values.backend.secrets.openRouterApiKey | quote }}
  {{- end }}

  # OpenRouter Base URL
  {{- if .Values.backend.secrets.baseUrl }}
  BASE_URL: {{ .Values.backend.secrets.baseUrl | quote }}
  {{- end }}

  # Model Name
  {{- if .Values.backend.secrets.modelName }}
  model_name: {{ .Values.backend.secrets.modelName | quote }}
  {{- end }}

  # OpenAI API Key (fallback)
  {{- if .Values.backend.secrets.openaiApiKey }}
  OPENAI_API_KEY: {{ .Values.backend.secrets.openaiApiKey | quote }}
  {{- end }}

  # Better Auth Secret (for JWT validation)
  {{- if .Values.backend.secrets.betterAuthSecret }}
  BETTER_AUTH_SECRET: {{ .Values.backend.secrets.betterAuthSecret | quote }}
  {{- end }}

  # Neon PostgreSQL Database URL
  {{- if .Values.backend.secrets.databaseUrl }}
  DATABASE_URL: {{ .Values.backend.secrets.databaseUrl | quote }}
  {{- end }}

  # Internal Service Token (for MCP server)
  {{- if .Values.backend.secrets.internalServiceToken }}
  INTERNAL_SERVICE_TOKEN: {{ .Values.backend.secrets.internalServiceToken | quote }}
  {{- end }}

  # Phase 2 API URL (if needed)
  {{- if .Values.backend.secrets.phase2ApiUrl }}
  PHASE2_API_URL: {{ .Values.backend.secrets.phase2ApiUrl | quote }}
  {{- end }}
{{- end }}
